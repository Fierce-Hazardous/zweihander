{"_id":"DZv40sNDUmKQRgh4","name":"Mass Create Items To Pack (Draft)","type":"script","author":"JyjuBRFhP4y9QWxg","img":"systems/zweihander/assets/icons/cloud-download.svg","scope":"global","command":"const pack = game.packs.get('zweihander.zh-traits');\nconst type = 'trait';\nconst d = () => ({ type });\nconst struc = [\n  'name',\n  'data.effect.value',\n];\nconst data = [\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``,\n  ``\n];\nlet i = 0;\nconst docs = [];\nwhile (data[i]) {\n  const doc = d();\n  for (key of struc) {\n    doc[key] = data[i];\n    i++;\n  }\n  docs.push(doc);\n}\nconst items = await Item.create(docs, { temporary: true });\nfor (let item of items) {\n  await pack.configure({ locked: false });\n  await pack.importDocument(item);\n  await pack.configure({ locked: true });\n}","folder":null,"sort":0,"permission":{"default":0,"JyjuBRFhP4y9QWxg":3},"flags":{"core":{"sourceId":"Macro.ePTQPNwzwV2FyELV"}}}
{"name":"Import Zweihander Trappings into Folders by Category","type":"script","author":"JyjuBRFhP4y9QWxg","img":"systems/zweihander/assets/icons/cloud-download.svg","scope":"global","command":"const pack = game.packs.get('zweihander.zh-trappings');\nconst docs = await pack.getDocuments();\nconst catFolders = {};\nfor (let doc of docs) {\n const cat = doc.data.data.category.value ?? 'Trappings';\n if (!(cat in catFolders)) {\n   catFolders[cat] = await Folder.create({type: \"Item\", name: cat});\n}\n const folder = catFolders[cat];\nconst d = doc.toObject();\nd.folder = folder.id;\n await Item.create(d);\n}","folder":null,"sort":0,"permission":{"default":0,"JyjuBRFhP4y9QWxg":3},"flags":{"core":{"sourceId":"Macro.ePTQPNwzwV2FyELV"}},"_id":"Rhmq08gRKPkG3VtG"}
{"name":"Convert Item Types","type":"script","author":"JyjuBRFhP4y9QWxg","img":"systems/zweihander/assets/icons/recycle.svg","scope":"global","command":"function getFolderNames() {\n  let tables = game.folders.filter(f => f.type === 'Item').reduce((acc, table) => {\n    acc.push({ key: table.id, name: table.name });\n    return acc;\n  }, []);\n  return tables;\n}\n\nlet folders = getFolderNames();\nlet content = `<form><div style=\"display: inline-block; width: 100%; margin-bottom: 10px\">\n  <p>This script will transform items in a folder to another type. </p>\n  <label for=\"output-targetFolder\" style=\"vertical-align: top; margin-right: 10px;\">Select Folder:</label>\n  <br /><select name='output-targetFolder' id='output-targetFolder'>`\n\nfolders.forEach(item => {\n  content += `<option value='${item.key}'>${item.name}</option>`;\n});\n\ncontent += `</select><br/><label for=\"output-sourceType\" style=\"vertical-align: top; margin-right: 10px;\">Source Type:</label><br /><select name=\"output-sourceType\" id=\"output-sourceType\">`;\n\n['talent', 'trait', 'quality'].forEach(x => {\n  content += `<option value='${x}'>${x}</option>`;\n});\n\ncontent += `</select><br/><label for=\"output-targetType\" style=\"vertical-align: top; margin-right: 10px;\">Target Type:</label><br /><select name=\"output-targetType\" id=\"output-targetType\">`;\n\n['trait', 'quality', 'talent'].forEach(x => {\n  content += `<option value='${x}'>${x}</option>`;\n});\n\ncontent += `</select></div><br /></form>`;\n\nconst convertTypes = async (f, st, tt) => {\n  const x = game.items.filter(i => i.folder?.id === f && i.type === st);\n\n  for (let i of x) {\n    await i.update({ type: tt });\n  };\n}\n\nnew Dialog({\n  title: `GeekDad's Compendium to Rolltable Converter`,\n  content: content,\n  buttons: {\n    yes: {\n      icon: \"<i class='fas fa-check'></i>\",\n      label: \"Convert\",\n      callback: (html) => {\n        let targetFolder = html.find(\"select[name='output-targetFolder']\").val();\n        let sourceType = html.find(\"select[name='output-sourceType']\").val();\n        let targetType = html.find(\"select[name='output-targetType']\").val();\n        convertTypes(targetFolder, sourceType, targetType);\n      }\n    },\n    no: {\n      icon: \"<i class='fas fa-times'></i>\",\n      label: 'Cancel'\n    }\n  },\n  default: \"yes\"\n}).render(true);","folder":null,"sort":0,"permission":{"default":0,"JyjuBRFhP4y9QWxg":3},"flags":{"core":{"sourceId":"Macro.T7XuJ2pRlu9EoaVk"}},"_id":"aXPKKmC6fJgQCLfe"}
{"_id":"k9oOuaZFvmQ1YfUr","name":"Start Flames Migration","type":"script","author":"JyjuBRFhP4y9QWxg","img":"icons/svg/upgrade.svg","scope":"global","command":"game.zweihander.migrateFlames()","folder":null,"sort":0,"permission":{"default":0,"JyjuBRFhP4y9QWxg":3},"flags":{"core":{"sourceId":"Macro.SXOyS13a17pm0agq"}}}
